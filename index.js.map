{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '53386228-9ccf01ca4b721fbc8928b7547'; \nconst BASE_URL = 'https://pixabay.com/api/';\nconst PER_PAGE = 15; \n\nexport async function getImagesByQuery(query, page = 1) {\ntry {\n    const response = await axios.get(BASE_URL, {\n    params: {\n        key: API_KEY,\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        per_page: PER_PAGE,\n        page,\n    },\n    });\n\n    return response.data;\n} catch (error) {\n    throw error;\n}\n}","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst GALLERY_SELECTOR = '.gallery';\nconst LOADER_SELECTOR = '.loader';\nconst LOAD_MORE_SELECTOR = '.load-more';\n\nconst galleryRef = document.querySelector(GALLERY_SELECTOR);\nconst loaderRef = document.querySelector(LOADER_SELECTOR);\nconst loadMoreRef = document.querySelector(LOAD_MORE_SELECTOR);\n\nconst lightbox = new SimpleLightbox(`${GALLERY_SELECTOR} a`, {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nexport function createGallery(images = []) {\n  if (!galleryRef) return;\n\n  const markup = images\n    .map(img => {\n      return `\n        <li class=\"gallery__item\">\n          <a class=\"gallery__link\" href=\"${img.largeImageURL}\">\n            <div class=\"photo-card\">\n              <img class=\"photo-card__img\" src=\"${img.webformatURL}\" alt=\"${img.tags}\" loading=\"lazy\" />\n              <div class=\"info\">\n                <p class=\"info-item\"><b>Likes</b><br>${img.likes}</p>\n                <p class=\"info-item\"><b>Views</b><br>${img.views}</p>\n                <p class=\"info-item\"><b>Comments</b><br>${img.comments}</p>\n                <p class=\"info-item\"><b>Downloads</b><br>${img.downloads}</p>\n              </div>\n            </div>\n          </a>\n        </li>\n      `;\n    })\n    .join('');\n\n  galleryRef.insertAdjacentHTML('beforeend', markup);\n\n  lightbox.refresh();\n}\nexport function clearGallery() {\n  if (!galleryRef) return;\n  galleryRef.innerHTML = '';\n  lightbox.refresh();\n}\n\nexport function showLoader() {\n  if (!loaderRef) return;\n  loaderRef.classList.remove('is-hidden');\n}\n\nexport function hideLoader() {\n  if (!loaderRef) return;\n  loaderRef.classList.add('is-hidden');\n}\n\nexport function showLoadMoreButton() {\n  if (!loadMoreRef) return;\n  loadMoreRef.classList.remove('is-hidden');\n}\n\nexport function hideLoadMoreButton() {\n  if (!loadMoreRef) return;\n  loadMoreRef.classList.add('is-hidden');\n}\n\nexport const refs = {\n  galleryRef,\n  loaderRef,\n  loadMoreRef,\n};\n","import { getImagesByQuery } from './js/pixabay-api.js';\nimport {\n    createGallery,\n    clearGallery,\n    showLoader,\n    hideLoader,\n    showLoadMoreButton,\n    hideLoadMoreButton,\n    refs,\n} from './js/render-functions.js';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst form = document.querySelector('.form');\nconst input = document.querySelector('.form-input');\n\nconst loadMoreBtn = refs.loadMoreRef;\nconst gallery = refs.galleryRef;\n\nlet currentQuery = ''; \nlet page = 1;            \nlet totalHits = 0;       \nconst PER_PAGE = 15;     \n\nif (!form || !input) {\nconsole.error('Не знайдено .form або .form-input в DOM.');\n}\n\nform.addEventListener('submit', onSearchSubmit);\nif (loadMoreBtn) loadMoreBtn.addEventListener('click', onLoadMore);\n\nasync function onSearchSubmit(e) {\ne.preventDefault();\nconst query = input.value.trim();\n\nif (!query) {\n    iziToast.warning({\n    title: 'Увага',\n    message: 'Будь ласка, введіть слово для пошуку.',\n    position: 'topRight',\n    timeout: 3000,\n    });\n    return;\n}\n\nconst isNewSearch = query !== currentQuery;\nif (isNewSearch) {\n    currentQuery = query;\n    page = 1;\n    totalHits = 0;\n    clearGallery();\n    hideLoadMoreButton();\n}\nawait fetchAndRender();\n}\n\nasync function onLoadMore() {\nawait fetchAndRender();\nscrollAfterLoad();\n}\n\nasync function fetchAndRender() {\nif (!currentQuery) return;\nshowLoader();\ntry {\n    const data = await getImagesByQuery(currentQuery, page);\n\n    if (!data || !Array.isArray(data.hits)) {\n    throw new Error('Unexpected response from API');\n    }\n\n    if (data.hits.length === 0 && page === 1) {\n    iziToast.info({\n        title: 'Немає результатів',\n        message: 'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n        timeout: 4000,\n    });\n    hideLoadMoreButton();\n    return;\n    }\n\n    if (page === 1) {\n    totalHits = data.totalHits || 0;\n    iziToast.success({\n        title: 'Успіх',\n        message: `Знайдено ${totalHits} зображень за запитом \"${currentQuery}\".`,\n        position: 'topRight',\n        timeout: 3000,\n    });\n    }\n\n    createGallery(data.hits);\n\n    const loadedImagesCount = (page - 1) * PER_PAGE + data.hits.length;\n\n    if (loadedImagesCount >= totalHits) {\n    hideLoadMoreButton();\n    iziToast.info({\n        title: 'Кінець колекції',\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n        timeout: 4000,\n    });\n    } else {\n    showLoadMoreButton();\n    page += 1;\n    }\n} catch (err) {\n    console.error(err);\n    iziToast.error({\n    title: 'Помилка',\n    message: 'Не вдалося завантажити зображення. Перевірте інтернет-зʼєднання або повторіть спробу.',\n    position: 'topRight',\n    timeout: 5000,\n    });\n} finally {\n    hideLoader();\n}\n}\n\nfunction scrollAfterLoad() {\nif (!gallery) return;\nconst firstCard = gallery.querySelector('.gallery__item');\nif (!firstCard) return;\nconst { height } = firstCard.getBoundingClientRect();\nwindow.scrollBy({\n    top: height * 2,\n    behavior: 'smooth',\n});\n}"],"names":["API_KEY","BASE_URL","PER_PAGE","getImagesByQuery","query","page","axios","error","GALLERY_SELECTOR","LOADER_SELECTOR","LOAD_MORE_SELECTOR","galleryRef","loaderRef","loadMoreRef","lightbox","SimpleLightbox","createGallery","images","markup","img","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","refs","form","input","loadMoreBtn","gallery","currentQuery","totalHits","onSearchSubmit","onLoadMore","iziToast","fetchAndRender","scrollAfterLoad","data","err","firstCard","height"],"mappings":"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"}